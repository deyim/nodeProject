<div class="cont">
	<div class="titlearea">
		<div class="title">상품정보</div>
		<div class="nav">스토어관리 > 상품조회 > 상품등록</div>
	</div>
	
	<div class="product_write">
		<table cellpadding="0" cellspacing="0" class="de_table">
			<tbody>
				<tr>
					<th>카테고리*</th>
					<td colspan="3">
						
						<div class="category_box">
							<select class="inputstyle" name="category">
									{{#each categories}}
										<option value={{this.id}}>{{this.name}}</option> 
									{{/each}}
							</select>
						</div>
					</td>
				</tr>
				
				<tr>
					<th>국가 / 도시선택 *</th>
					<td>
						<div class="nation_city">
							<h4>1.국가선택</h5>
							<select multiple size="10" class="inputstyle" name="nation" id="nation_select">
								{{#each nations}}
									<option class="nation_option" value={{this.id}}>{{this.nation}}</option> 
								{{/each}}
							</select>
							{{!-- <ul class="box">
								{{#each nations}}
									<li>{{this.nation}}</li>
								{{/each}}
							</ul> --}}
						</div>
						
						<div class="nation_city">
							<h4>2.도시선택</h5>
							<select multiple size="10" class="inputstyle" name="city" id="city_select">
								{{#each cities}}
									<option class="city_option" value={{this.id}}>{{this.city}}</option> 
								{{/each}}
							</select>
							{{!-- <ul class="box">
								{{#each cities}}
									<li>{{this.city}}</li>
								{{/each}}
							</ul> --}}
						</div>
					</td>
					
					<th>선택정보</th>
					<td>
						<div id="nation_city">
								<input class="inputstyle" id="nation" type="text" name="nation">
								<input class="inputstyle" id="city" type="text" name="city">
						</div>					
					</td>
				</tr>
				
				<tr>
					<th>상품코드</th>
					<td>
						<div class="input_100box">
							<input class="inputstyle" id="productcode" type="text" name="productcode">
						</div>						
						<button id="codebutton">코드등록</button>
						{{!-- 옆으로 붙여라 나중에 --}}
					</td>
					<th>상품등록일자</th>
					<td>{{today}}</td>
				</tr>
				
				
				<tr>
					<th>상품명 *</th>
					<td colspan="3">
						<div class="input_100box"><input type="text" class="inputstyle" name="title"></input></div>
					</td>
				</tr>
				
				<tr>
					<th>홍보키워드</th>
					<td colspan="3">
						<div class="input_12box"><input type="text" class="inputstyle" name="tag1"></input></div>
						<div class="input_12box"><input type="text" class="inputstyle" name="tag2"></input></div>
						<div class="input_12box"><input type="text" class="inputstyle" name="tag3"></input></div>
						<div class="input_12box"><input type="text" class="inputstyle" name="tag4"></input></div>
						<div class="input_12box"><input type="text" class="inputstyle" name="tag5"></input></div>
					</td>
				</tr>
				
				<tr>
					<th>긱상태</th>
					<td colspan="3">
						<div class="inline"><input type="checkbox" name="onSaleChk" checked></input> 판매중</div>
					</td>
				</tr>
				
				
				<tr>
					<th>판매기간설정</th>
					<td colspan="3">
						<div class="calendar_box"><input type="date" name="startdate" value={{today}}><span><img src="/images/sub/calendar.jpg"></span></div>
						<div class="inline">-</div>
						<div class="calendar_box"><input type="date" name="enddate"><span><img src="/images/sub/calendar.jpg"></span></div>
						<div class="priod_box">
							<select class="inputstyle">
								<option>90일</option>
								<option>120일</option>
								<option>150일</option>
							</select>
						</div>
					</td>
				</tr>
				
				<tr>
					<th>예약불가자일자 설정</th>
					<td colspan="3">
						<div class="calendar_box"><input type="date" id="tmp"><span><img src="/images/sub/calendar.jpg"></span></div>
						<button id="unavailable">추가</button>
						<div class="input_80box alret_date">
							<input type="text" class="inputstyle" id="unavailables" name="unavailables"></input>
						</div>
					</td>
				</tr>
				
				<tr>
					<th>상품 특성</th>
					<td colspan="3">
						<div class="inline"><input type="checkbox" name="periodType" value="A"></input> 기간일자 상품</div>
						<div class="inline"><input type="checkbox" name="periodType" value="B"></input> 단일일자 상품</div>
					</td>
				</tr>
				
				<tr>
					<th>상품 유형</th>
					<td colspan="3">
						<div class="listdg_button">
							<div class="inline"><input type="checkbox"></input> 단일 옵션상품</div>
							<div class="inline"><input type="checkbox"></input> 인원 옵션상품</div>					
						</div>
					</td>
				</tr>
				
				<tr>
					<th>옵션/가격 *</th>
					<td colspan="3">
						<div class="listdg_button">
							<div class="inline">옵션명</div>
							<div class="input_80box"><input type="text" class="inputstyle"></input></div>
							
							{{!-- <div class="inline">가격</div>
							<div class="input_12box"><input type="text" class="inputstyle"></input></div> --}}
							<div class="dg_button" id="add_option">옵션추가</div>						
							{{!-- <div class="dg_button">옵션삭제</div> --}}
						</div>
					</td>
				</tr>
				
				<tr class="option_content">
					<th>추가옵션/가격 *</th>
					<td colspan="3">
						<div class="listdg_button" id="price_content">							
							<div class="inline"><input type="checkbox" name="periodType" value=""></input> 성인</div>
							<div class="inline"><input type="checkbox" name="periodType" value=""></input> 아동</div>
							<div class="input_8box">
								<input type="text" class="inputstyle"></input>
							</div>명
							<div class="inline">-</div>
							<div class="input_8box">
								<input type="text" class="inputstyle"></input>
							</div>명: 
							<div class="input_12box">
								<input type="text" class="inputstyle"></input>
							</div>
							<div class="inline">원</div>
							
							<div class="plus_button remove_price" >
								<img src="/images/sub/plus_option.png">	
							</div>
							<div class="plus_button add_price" >
								<img src="/images/sub/plus_option.png">	
							</div>
							
						</div>
					</td>
				</tr>
				
				
				
				<tr>
					<th>대표이미지 *</th>
					<td colspan="3">
						<div class="compulsory_img">
							<div class="compulory_text">대표이미지</div>
							<div class="image"><img src="/images/sub/ex_img.jpg"></div>
							<div class="buttonarea">
								<div class="change">변경</div>
								<div class="delete">삭제</div>
							</div>
						</div>
						
						<div class="compulsory_img">
							<div class="compulory_text">추가이미지</div>
							<div class="image">
								<div class="plus_imgicon"><img src="/images/sub/plus_img.png"></div>
							</div>
							<div class="buttonarea">
								<div class="change">찾아보기</div>
								
							</div>
						</div>
						
						<div class="compulsory_img">
							<div class="compulory_text">추가이미지</div>
							<div class="image">
								<div class="plus_imgicon"><img src="/images/sub/plus_img.png"></div>
							</div>
							<div class="buttonarea">
								<div class="change">찾아보기</div>
								
							</div>
						</div>
						
						<div class="compulsory_img">
							<div class="compulory_text">추가이미지</div>
							<div class="image">
								<div class="plus_imgicon"><img src="/images/sub/plus_img.png"></div>
							</div>
							<div class="buttonarea">
								<div class="change">찾아보기</div>
								
							</div>
						</div>
					</td>
				</tr>
				
				<tr>
					<th>목록이미지 *</th>
					<td colspan="3">
						<div class="listdg_button">
							<div class="dg_button">미리보기</div>
						</div>
						<div class="mar_t10"><textarea rows="15" class="textareastyle"></textarea></div>
					</td>
				</tr>
				
				<tr>
					<th>취소/환불안내 *</th>
					<td colspan="3">
						<textarea rows="5" class="textareastyle"></textarea>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	
	<div class="bot_button">
		<div class="bl_button">등록완료</div>
		<div class="wt_button">초기화</div>
	</div>
	
</div>

<script>
	$(document).ready(function(){
		$("#codebutton").click(function(){
			$.ajax({
				url: "/stores/products/getproductcode", 
				success: function(result){
					$("#productcode").val(result.code);
			}});
		});
	});

	$(document).ready(function(){
		$(".nation_option").click(function(){
			$.ajax({
				url: "/stores/products/updatenation", 
				data: {
					nation: $(this).val()
				},
				success: function(result){
					console.log("working");
					$("#nation").val(result.nation);
					var $s = $('#city_select');
					var optionTop = $s.find("option:contains('"+result.nation+"')").offset().top;
					var selectTop = $s.offset().top;
					$s.scrollTop($s.scrollTop()+optionTop-selectTop);
			}});
		});
	});

	 $(document).ready(function(){
		$(".city_option").click(function(){
			$.ajax({
				url: "/stores/products/updatecity", 
				data: {
					city: $(this).val()
				},
				success: function(result){
					originalValue = $("#city").val();
					if(originalValue===''){
						originalValue = result.city;
					}else{
						originalValue = originalValue + ',' + result.city;
					}										
					$("#city").val(originalValue);
			}});
		});
	}); 

	$(document).ready(function(){
		$("#unavailable").click(function(){
			originalValue = $("#unavailables").val();
			newValue = $("#tmp").val();
			if(originalValue===''){
				originalValue = newValue;
			}else{
				originalValue = originalValue + ',' + newValue;
			}										
			$("#unavailables").val(originalValue);
		});
	}); 

	$(document).ready(function(){
		$(document).on('click', '.add_option', function(){
			var price = $('#price_content').html();
			var newdiv = $("<div class='listdg_button' id='price_content'>");
			newdiv.html(price);
        	$('#price_content').after(newdiv);
		});
	}); 

	$(document).ready(function(){
		$(document).on('click', '.add_price', function(){
			var price = $('#price_content').html();
			var newdiv = $("<div class='listdg_button' id='price_content'>");
			newdiv.html(price);
        	$('#price_content').after(newdiv);
		});
	}); 

	$(document).ready(function(){
		$(document).on('click', '.remove_price', function(){
			console.log($(this).parent());
			$(this).parent().remove();
		});
	}); 

</script>
